!function(){"use strict";function t(t){var e=$(t.target).find("h2.mg-chart-title");if(t.title&&t.title!==e.text()){if(e.remove(),t.target&&t.title){var r,a=t.description?'<i class="fa fa-question-circle fa-inverse"></i>':"";$(t.target).prepend('<h2 class="mg-chart-title">'+t.title+a+"</h2>"),t.description&&(r=$(t.target).find("h2.mg-chart-title"),r.popover({html:!0,animation:!1,content:t.description,trigger:"hover",placement:"top",container:r}))}t.error&&_(t)}}function e(t){for(var e=d3.select($(t.target).find("svg").get(0)),r="point"==t.chart_type?t.buffer/2:2*t.buffer/3,a=[],n=0;n<t.data.length;n++)for(var o=0;o<t.data[n].length;o++)a.push(t.data[n][o]);var s=e.selectAll("line.mg-y-rug").data(a);s.enter().append("svg:line").attr("class","mg-y-rug").attr("opacity",.3),s.exit().remove(),s.exit().remove(),s.attr("x1",t.left+1).attr("x2",t.left+r).attr("y1",t.scalefns.yf).attr("y2",t.scalefns.yf),t.color_accessor?(s.attr("stroke",t.scalefns.color),s.classed("mg-y-rug-mono",!1)):(s.attr("stroke",null),s.classed("mg-y-rug-mono",!0))}function r(t){function r(t){return 1e3==t?3:1e6==t?7:Math.log(t)/Math.LN10}var a,n,o,s=d3.select($(t.target).find("svg").get(0)),i=$($(t.target).find("svg").get(0));t.scalefns.yf=function(e){return t.scales.Y(e[t.y_accessor])};for(var n,o,l=!1,c=0;c<t.data.length;c++){var d=t.data[c];if("log"==t.y_scale_type&&(d=d.filter(function(e){return e[t.y_accessor]>0})),d.length>0){var u=d3.extent(d,function(e){return e[t.y_accessor]});l?(n=Math.min(u[0],n),o=Math.max(u[1],o)):(n=u[0],o=u[1],l=!0)}}n>=0&&!t.min_y&&!t.min_y_from_data&&(n=0),n=t.min_y?t.min_y:n,o=t.max_y?t.max_y:o,"log"!=t.y_scale_type&&(n>=0?t.y_axis_negative=!1:(n-=o*(t.inflator-1),t.y_axis_negative=!0)),o*=t.inflator,!t.min_y&&t.min_y_from_data&&(n/=t.inflator),"log"==t.y_scale_type?("histogram"==t.chart_type?n=.2:0>=n&&(n=1),t.scales.Y=d3.scale.log().domain([n,o]).range([t.height-t.bottom-t.buffer,t.top]).clamp(!0)):t.scales.Y=d3.scale.linear().domain([n,o]).range([t.height-t.bottom-t.buffer,t.top]),t.scales.Y_axis=d3.scale.linear().domain([n,o]).range([t.height-t.bottom-t.buffer,t.top]);var f;if(f="count"==t.format?function(e){if(1>e)return t.yax_units+d3.round(e,t.decimals);var r=d3.formatPrefix(e);return t.yax_units+r.scale(e)+r.symbol}:function(t){var e=d3.format("%p");return e(t)},i.find(".mg-y-axis").remove(),!t.y_axis)return this;a=s.append("g").classed("mg-y-axis",!0).classed("mg-y-axis-small",t.use_small_class),t.y_label&&a.append("text").attr("class","label").attr("x",function(){return-1*(t.top+t.buffer+(t.height-t.bottom-t.buffer-(t.top+t.buffer))/2)}).attr("y",function(){return t.left/2}).attr("dy","0.4em").attr("text-anchor","middle").text(function(){return t.y_label}).attr("transform",function(){return"rotate(-90)"});var p=t.scales.Y.ticks(t.yax_count);"log"==t.y_scale_type&&(p=p.filter(function(t){return Math.abs(r(t))%1<1e-6||Math.abs(r(t))%1>1-1e-6}));var h=t.scales.Y.ticks(t.yax_count).length,g=!0;$.each(t.data,function(e,r){$.each(r,function(e,r){return r[t.y_accessor]%1!==0?(g=!1,!1):void 0})}),g&&h>o&&"count"==t.format&&(p=p.filter(function(t){return t%1===0}));var m=p.length-1;return t.x_extended_ticks||t.y_extended_ticks||a.append("line").attr("x1",t.left).attr("x2",t.left).attr("y1",t.scales.Y(p[0]).toFixed(2)).attr("y2",t.scales.Y(p[m]).toFixed(2)),a.selectAll(".mg-yax-ticks").data(p).enter().append("line").classed("mg-extended-y-ticks",t.y_extended_ticks).attr("x1",t.left).attr("x2",function(){return t.y_extended_ticks?t.width-t.right:t.left-t.yax_tick_length}).attr("y1",function(e){return t.scales.Y(e).toFixed(2)}).attr("y2",function(e){return t.scales.Y(e).toFixed(2)}),a.selectAll(".mg-yax-labels").data(p).enter().append("text").attr("x",t.left-3*t.yax_tick_length/2).attr("dx",-3).attr("y",function(e){return t.scales.Y(e).toFixed(2)}).attr("dy",".35em").attr("text-anchor","end").text(function(t){var e=f(t);return e}),t.y_rug&&e(t),this}function a(t){var e=t.height;"bar"==t.chart_type&&null==e,t.scales.Y=d3.scale.ordinal().domain(t.categorical_variables).rangeRoundBands([t.height-t.bottom-t.buffer,t.top],t.padding_percentage,t.outer_padding_percentage),t.scalefns.yf=function(e){return t.scales.Y(e[t.y_accessor])};var r=d3.select($(t.target).find("svg").get(0)),a=$($(t.target).find("svg").get(0));a.find(".mg-y-axis").remove();var n=r.append("g").classed("mg-y-axis",!0).classed("mg-y-axis-small",t.use_small_class);return t.y_axis?(n.selectAll("text").data(t.categorical_variables).enter().append("svg:text").attr("x",t.left).attr("y",function(e){return t.scales.Y(e)+t.scales.Y.rangeBand()/2+t.buffer*t.outer_padding_percentage}).attr("dy",".35em").attr("text-anchor","end").text(String),this):this}function n(t){for(var e="point"==t.chart_type?t.buffer/2:t.buffer,r=d3.select($(t.target).find("svg").get(0)),a=[],n=0;n<t.data.length;n++)for(var o=0;o<t.data[n].length;o++)a.push(t.data[n][o]);var s=r.selectAll("line.mg-x-rug").data(a);s.enter().append("svg:line").attr("class","mg-x-rug").attr("opacity",.3),s.exit().remove(),s.exit().remove(),s.attr("x1",t.scalefns.xf).attr("x2",t.scalefns.xf).attr("y1",t.height-t.top+e).attr("y2",t.height-t.top),t.color_accessor?(s.attr("stroke",t.scalefns.color),s.classed("mg-x-rug-mono",!1)):(s.attr("stroke",null),s.classed("mg-x-rug-mono",!0))}function o(t){var e,r,a,o=d3.select($(t.target).find("svg").get(0)),s=$($(t.target).find("svg").get(0));if(t.scalefns.xf=function(e){return t.scales.X(e[t.x_accessor])},"point"==t.chart_type){var i,l,c,d,u,f,p,h;null!=t.color_accessor&&(null==t.color_domain?"number"==t.color_type?(c=d3.min(t.data[0],function(e){return e[t.color_accessor]}),d=d3.max(t.data[0],function(e){return e[t.color_accessor]}),h=[c,d]):"category"==t.color_type&&(h=d3.set(t.data[0].map(function(e){return e[t.color_accessor]})).values(),h.sort()):h=t.color_domain,f=null==t.color_range?"number"==t.color_type?["blue","red"]:null:t.color_range,"number"==t.color_type?t.scales.color=d3.scale.linear().domain(h).range(f).clamp(!0):(t.scales.color=null!=t.color_range?d3.scale.ordinal().range(f):h.length>10?d3.scale.category20():d3.scale.category10(),t.scales.color.domain(h)),t.scalefns.color=function(e){return t.scales.color(e[t.color_accessor])}),null!=t.size_accessor&&(null==t.size_domain?(i=d3.min(t.data[0],function(e){return e[t.size_accessor]}),l=d3.max(t.data[0],function(e){return e[t.size_accessor]}),p=[i,l]):p=t.size_domain,u=null==t.size_range?[1,5]:t.size_range,t.scales.size=d3.scale.linear().domain(p).range(u).clamp(!0),t.scalefns.size=function(e){return t.scales.size(e[t.size_accessor])})}var g;if("line"==t.chart_type)for(var m=0;m<t.data.length;m++)g=t.data[m].length-1,(t.data[m][0][t.x_accessor]<r||!r)&&(r=t.data[m][0][t.x_accessor]),(t.data[m][g][t.x_accessor]>a||!a)&&(a=t.data[m][g][t.x_accessor]);else"point"==t.chart_type?(a=d3.max(t.data[0],function(e){return e[t.x_accessor]}),r=d3.min(t.data[0],function(e){return e[t.x_accessor]})):"histogram"==t.chart_type?(r=d3.min(t.data[0],function(e){return e[t.x_accessor]}),a=d3.max(t.data[0],function(e){return e[t.x_accessor]}),t.xax_format=function(e){if(1>e)return t.yax_units+d3.round(e,t.decimals);var r=d3.formatPrefix(e);return t.xax_units+r.scale(e)+r.symbol}):"bar"==t.chart_type&&(r=0,a=d3.max(t.data[0],function(e){var r=[];return r.push(e[t.x_accessor]),null!=t.baseline_accessor&&r.push(e[t.baseline_accessor]),null!=t.predictor_accessor&&r.push(e[t.predictor_accessor]),Math.max.apply(null,r)}),t.xax_format=function(e){if(1>e)return t.yax_units+d3.round(e,t.decimals);var r=d3.formatPrefix(e);return t.xax_units+r.scale(e)+r.symbol});r=t.min_x?t.min_x:r,a=t.max_x?t.max_x:a,t.x_axis_negative=!1,t.time_series||0>r&&(r-=a*(t.inflator-1),t.x_axis_negative=!0);var v;if(v="bar"==t.chart_type?5*t.buffer:0,t.scales.X=t.time_series?d3.time.scale():d3.scale.linear(),t.scales.X.domain([r,a]).range([t.left+t.buffer,t.width-t.right-t.buffer-v]),s.find(".mg-x-axis").remove(),!t.x_axis)return this;e=o.append("g").classed("mg-x-axis",!0).classed("mg-x-axis-small",t.use_small_class);var g=t.scales.X.ticks(t.xax_count).length-1;if(t.x_label&&e.append("text").attr("class","label").attr("x",function(){return t.left+t.buffer+(t.width-t.right-t.buffer-(t.left+t.buffer))/2}).attr("y",(t.height-t.bottom/2).toFixed(2)).attr("dy",".50em").attr("text-anchor","middle").text(function(){return t.x_label}),"bar"==t.chart_type||t.x_extended_ticks||t.y_extended_ticks||e.append("line").attr("x1",0==t.concise||0==t.xax_count?t.left+t.buffer:t.scales.X(t.scales.X.ticks(t.xax_count)[0]).toFixed(2)).attr("x2",0==t.concise||0==t.xax_count?t.width-t.right-t.buffer:t.scales.X(t.scales.X.ticks(t.xax_count)[g]).toFixed(2)).attr("y1",t.height-t.bottom).attr("y2",t.height-t.bottom),e.selectAll(".mg-xax-ticks").data(t.scales.X.ticks(t.xax_count)).enter().append("line").attr("x1",function(e){return t.scales.X(e).toFixed(2)}).attr("x2",function(e){return t.scales.X(e).toFixed(2)}).attr("y1",t.height-t.bottom).attr("y2",function(){return t.x_extended_ticks?t.top:t.height-t.bottom+t.xax_tick_length}).attr("class",function(){return t.x_extended_ticks?"mg-extended-x-ticks":void 0}),e.selectAll(".mg-xax-labels").data(t.scales.X.ticks(t.xax_count)).enter().append("text").attr("x",function(e){return t.scales.X(e).toFixed(2)}).attr("y",(t.height-t.bottom+7*t.xax_tick_length/3).toFixed(2)).attr("dy",".50em").attr("text-anchor","middle").text(function(e){return t.xax_units+t.xax_format(e)}),t.time_series&&t.show_years){for(var r,a,m=0;m<t.data.length;m++)g=t.data[m].length-1,(t.data[m][0][t.x_accessor]<r||!r)&&(r=t.data[m][0][t.x_accessor]),(t.data[m][g][t.x_accessor]>a||!a)&&(a=t.data[m][g][t.x_accessor]);var _=d3.time.years(r,a);if(0==_.length){var y=t.scales.X.ticks(t.xax_count)[0];_=[y]}e=e.append("g").classed("mg-year-marker",!0).classed("mg-year-marker-small",t.use_small_class),e.selectAll(".mg-year-marker").data(_).enter().append("line").attr("x1",function(e){return t.scales.X(e).toFixed(2)}).attr("x2",function(e){return t.scales.X(e).toFixed(2)}).attr("y1",t.top).attr("y2",t.height-t.bottom);var x=d3.time.format("%Y");e.selectAll(".mg-year-marker").data(_).enter().append("text").attr("x",function(e){return t.scales.X(e).toFixed(2)}).attr("y",(t.height-t.bottom+7*t.xax_tick_length/1.3).toFixed(2)).attr("dy",t.use_small_class?-3:0).attr("text-anchor","middle").text(function(t){return x(t)})}return t.x_rug&&n(t),this}function s(e){var r={target:null,title:null,description:null},e=arguments[0];e||(e={}),e=g(e,r),e.time_series="date"==$.type(e.data[0][0][e.x_accessor])?!0:!1;var a=e.width,n=e.height;"bar"==e.chart_type&&null==n&&(n=e.height=e.data[0].length*e.bar_height+e.top+e.bottom);var o=$(e.target).find("svg");(o.find(".mg-main-line").length>0&&"line"!=e.chart_type||o.find(".mg-points").length>0&&"point"!=e.chart_type||o.find(".mg-histogram").length>0&&"histogram"!=e.chart_type||o.find(".mg-barplot").length>0&&"bar"!=e.chart_type)&&$(e.target).empty(),""==$.trim($(e.target).html())&&d3.select(e.target).append("svg").classed("linked",e.linked).attr("width",a).attr("height",n);var o=d3.select(e.target).selectAll("svg");if(e.width!=Number(o.attr("width"))&&o.attr("width",e.width),e.height!=Number(o.attr("height"))&&o.attr("height",e.height),o.classed("mg-missing",!1),o.selectAll(".mg-missing-text").remove(),t(e),e.use_small_class=e.height-e.top-e.bottom-e.buffer<=e.small_height_threshold&&e.width-e.left-e.right-2*e.buffer<=e.small_width_threshold||e.small_text,e.data.length<$(e.target).find("svg .mg-main-line").length)if(e.custom_line_color_map.length>0)for(var s=function(t){for(var e=new Array(t),r=0;r<e.length;r++)e[r]=r+1;return e},i=m(s(e.max_data_size),e.custom_line_color_map),l=0;l<i.length;l++)$(e.target).find("svg .mg-main-line.mg-line"+i[l]+"-color").remove();else for(var c=e.data.length,d=$(e.target).find("svg .mg-main-line").length,l=d;l>c;l--)$(e.target).find("svg .mg-main-line.mg-line"+l+"-color").remove();return this}function i(t){var e,r,a=d3.select($(t.target).find("svg").get(0));return t.markers&&($(t.target).find("svg .mg-markers").remove(),e=a.append("g").attr("class","mg-markers"),e.selectAll(".mg-markers").data(t.markers.filter(function(e){return t.scales.X(e[t.x_accessor])>t.buffer+t.left&&t.scales.X(e[t.x_accessor])<t.width-t.buffer-t.right})).enter().append("line").attr("x1",function(e){return t.scales.X(e[t.x_accessor]).toFixed(2)}).attr("x2",function(e){return t.scales.X(e[t.x_accessor]).toFixed(2)}).attr("y1",t.top).attr("y2",function(){return t.height-t.bottom-t.buffer}).attr("stroke-dasharray","3,1"),e.selectAll(".mg-markers").data(t.markers.filter(function(e){return t.scales.X(e[t.x_accessor])>t.buffer+t.left&&t.scales.X(e[t.x_accessor])<t.width-t.buffer-t.right})).enter().append("text").attr("x",function(e){return t.scales.X(e[t.x_accessor])}).attr("y",t.top-8).attr("text-anchor","middle").text(function(t){return t.label})),t.baselines&&(a.selectAll(".mg-baselines").remove(),r=a.append("g").attr("class","mg-baselines"),r.selectAll(".mg-baselines").data(t.baselines).enter().append("line").attr("x1",t.left+t.buffer).attr("x2",t.width-t.right-t.buffer).attr("y1",function(e){return t.scales.Y(e.value).toFixed(2)}).attr("y2",function(e){return t.scales.Y(e.value).toFixed(2)}),r.selectAll(".mg-baselines").data(t.baselines).enter().append("text").attr("x",t.width-t.right-t.buffer).attr("y",function(e){return t.scales.Y(e.value).toFixed(2)}).attr("dy",-3).attr("text-anchor","end").text(function(t){return t.label})),this}function l(t){if("line"==t.chart_type){var e=t.data[0]instanceof Object&&!(t.data[0]instanceof Array),r=t.data[0]instanceof Array&&!(t.data[0][0]instanceof Object&&!(t.data[0][0]instanceof Date));(e||r)&&(t.data=[t.data])}else t.data[0]instanceof Array||(t.data=[t.data]);if(t.y_accessor instanceof Array&&(t.data=t.data.map(function(e){return t.y_accessor.map(function(t){return e.map(function(e){return e=y.clone(e),void 0==e[t]?void 0:(e.multiline_y_accessor=e[t],e)}).filter(function(t){return void 0!=t})})})[0],t.y_accessor="multiline_y_accessor"),"line"==t.chart_type)for(var a=0;a<t.data.length;a++)t.data[a].sort(function(e,r){return e[t.x_accessor]-r[t.x_accessor]});return this}function c(t){var e="date"==$.type(t.data[0][0][t.x_accessor])?!0:!1;if(t.missing_is_zero&&"line"==t.chart_type&&e)for(var r=0;r<t.data.length;r++){for(var a=t.data[r][0],n=t.data[r][t.data[r].length-1],o=[],s=y.clone(a[t.x_accessor]).setDate(a[t.x_accessor].getDate()+1),i=t.min_x?t.min_x:s,l=t.max_x?t.max_x:n[t.x_accessor],c=new Date(i);l>=c;c.setDate(c.getDate()+1)){var d={};c.setHours(0,0,0,0),Date.parse(c)==Date.parse(new Date(s))&&o.push(y.clone(t.data[r][0]));var u=null;$.each(t.data[r],function(t,e){return Date.parse(e.date)==Date.parse(new Date(c))?(u=e,!1):void 0}),u?o.push(u):(d[t.x_accessor]=new Date(c),d[t.y_accessor]=0,o.push(d)),Date.parse(c)==Date.parse(new Date(n[t.x_accessor]))&&o.push(n)}t.data[r]=o}return this}function d(t){var e,r=t.data[0];if(0==t.binned){if("object"==typeof r[0])e=r.map(function(e){return e[t.x_accessor]});else{if("number"!=typeof r[0])return void console.log("TypeError: expected an array of numbers, found "+typeof r[0]);e=r}var a=d3.layout.histogram();t.bins&&(a=a.bins(t.bins)),t.processed_data=a(e).map(function(t){return{x:t.x,y:t.y,dx:t.dx}})}else{t.processed_data=r.map(function(e){return{x:e[t.x_accessor],y:e[t.y_accessor]}});for(var n,o,s=0;s<t.processed_data.length;s++)n=t.processed_data[s],s==t.processed_data.length-1?n.dx=t.processed_data[s-1].dx:(o=t.processed_data[s+1],n.dx=o.x-n.x)}return t.data=[t.processed_data],t.x_accessor=t.processed_x_accessor,t.y_accessor=t.processed_y_accessor,this}function u(t){var e,r={},a=t.data[0];if(t.categorical_variables=[],0==t.binned){e="object"==typeof a[0]?a.map(function(e){return e[t.y_accessor]}):a;for(var n,o=0;o<e.length;o++)n=e[o],-1==t.categorical_variables.indexOf(n)&&t.categorical_variables.push(n),r.hasOwnProperty(n)||(r[n]=0),r[n]+=1;r=Object.keys(r).map(function(e){var a={};return a[t.x_accessor]=r[e],a[t.y_accessor]=e,a})}else r=a,t.categorical_variables=d3.set(r.map(function(e){return e[t.y_accessor]})).values(),t.categorical_variables.reverse();return t.data=[r],this}function f(t){var e=t.data[0],r=e.map(function(e){return e[t.x_accessor]}),a=e.map(function(e){return e[t.y_accessor]});return t.least_squares&&(t.ls_line=h(r,a)),this}function p(t){var e=d3.select($(t.target).find("svg").get(0)),r=(t.data[0],t.scales.X.ticks(t.xax_count)[0]),a=t.scales.X.ticks(t.xax_count)[t.scales.X.ticks(t.xax_count).length-1];e.append("svg:line").attr("x1",t.scales.X(r)).attr("x2",t.scales.X(a)).attr("y1",t.scales.Y(t.ls_line.fit(r))).attr("y2",t.scales.Y(t.ls_line.fit(a))).attr("class","mg-least-squares-line")}function h(t,e){{var r,a,n,o;t.length}r=t[0]instanceof Date?t.map(function(t){return t.getTime()}):t,a=e[0]instanceof Date?e.map(function(t){return t.getTime()}):e;for(var n,o,s=d3.mean(r),i=d3.mean(a),l=0,c=0,d=0;d<r.length;d++)n=r[d],o=a[d],l+=(n-s)*(o-i),c+=(n-s)*(n-s);var u=l/c,f=i-u*s;return{x0:f,beta:u,fit:function(t){return f+t*u}}}function g(t){return b(Array.prototype.slice.call(arguments,1),function(e){if(e)for(var r in e)void 0===t[r]&&(t[r]=e[r])}),t}function m(t,e){for(var r=[],a=[],n=0;n<e.length;n++)r[e[n]]=!0;for(var n=0;n<t.length;n++)r[t[n]]||a.push(t[n]);return a}function v(t,e){console.warn("Deprecation: "+t+(e?". This feature will be removed in "+e+".":" the near future.")),console.trace()}function _(t){var e='<i class="fa fa-x fa-exclamation-circle warning"></i>';console.log("ERROR : ",t.target," : ",t.error),$(t.target).find(".mg-chart-title").append(e)}var y={version:"2.0.0"},x={};if(y.globals={},y.deprecations={rollover_callback:{replacement:"mouseover",version:"2.0"},rollout_callback:{replacement:"mouseout",version:"2.0"}},y.globals.link=!1,y.globals.version="1.1",y.data_graphic=function(){var t={};t.all={missing_is_zero:!1,legend:"",legend_target:"",error:"",animate_on_load:!1,top:40,bottom:30,right:10,left:50,buffer:8,width:350,height:220,small_height_threshold:120,small_width_threshold:160,small_text:!1,xax_count:6,xax_tick_length:5,yax_count:5,yax_tick_length:5,x_extended_ticks:!1,y_extended_ticks:!1,y_scale_type:"linear",max_x:null,max_y:null,min_x:null,min_y:null,min_y_from_data:!1,point_size:2.5,x_accessor:"date",xax_units:"",x_label:"",x_axis:!0,y_axis:!0,y_accessor:"value",y_label:"",yax_units:"",x_rug:!1,y_rug:!1,transition_on_update:!0,mouseover:null,show_rollover_text:!0,show_confidence_band:null,xax_format:function(t){var r=d3.time.format("%b %d"),a=d3.formatPrefix(t);switch($.type(e.data[0][0][e.x_accessor])){case"date":return r(t);case"number":return a.scale(t)+a.symbol;default:return t}},area:!0,chart_type:"line",data:[],decimals:2,format:"count",inflator:10/9,linked:!1,list:!1,baselines:null,markers:null,scalefns:{},scales:{},show_years:!0,target:"#viz",interpolate:"cardinal",custom_line_color_map:[],max_data_size:null},t.point={buffer:16,ls:!1,lowess:!1,point_size:2.5,size_accessor:null,color_accessor:null,size_range:null,color_range:null,size_domain:null,color_domain:null,color_type:"number"},t.histogram={mouseover:function(t){$("#histogram svg .mg-active-datapoint").html("Frequency Count: "+t.y)},binned:!1,bins:null,processed_x_accessor:"x",processed_y_accessor:"y",processed_dx_accessor:"dx",bar_margin:1},t.bar={y_accessor:"factor",x_accessor:"value",baseline_accessor:null,predictor_accessor:null,predictor_proportion:5,dodge_accessor:null,binned:!0,padding_percentage:0,outer_padding_percentage:.1,height:500,top:20,bar_height:20,left:70},t.missing={top:0,bottom:0,right:0,left:0,legend_target:"",width:350,height:220,missing_text:"Data currently missing or unavailable"};var e=arguments[0];e||(e={});e.list&&(e.x_accessor=0,e.y_accessor=1);for(var r in y.deprecations)if(e.hasOwnProperty(r)){var a=y.deprecations[r],n="Use of `args."+r+"` has been deprecated",o=a.replacement;if(o&&(e[o]?n+=". The replacement - `args."+o+"` - has already been defined. This definition will be discarded.":e[o]=e[r]),a.warned)continue;a.warned=!0,o&&(n+=" in favor of `args."+o+"`"),v(n,a.version)}if("missing-data"==e.chart_type)e=g(e,t.missing),x.missing(e);else if("point"==e.chart_type){var s=g(t.point,t.all);e=g(e,s),x.point(e).mainPlot().markers().rollover()}else if("histogram"==e.chart_type){var s=g(t.histogram,t.all);e=g(e,s),x.histogram(e).mainPlot().markers().rollover()}else if("bar"==e.chart_type){var s=g(t.bar,t.all);e=g(e,s),x.bar(e).mainPlot().markers().rollover()}else e=g(e,t.all),x.line(e).markers().mainPlot().rollover();return e.data},"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");if(+function(t){var e=t.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function(t){function e(e){return this.each(function(){var a=t(this),n=a.data("bs.tooltip"),o="object"==typeof e&&e,s=o&&o.selector;(n||"destroy"!=e)&&(s?(n||a.data("bs.tooltip",n={}),n[s]||(n[s]=new r(this,o))):n||a.data("bs.tooltip",n=new r(this,o)),"string"==typeof e&&n[e]())})}if("function"==typeof t().tooltip)return!0;var r=function(t,e){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",t,e)};r.VERSION="3.3.1",r.TRANSITION_DURATION=150,r.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},r.prototype.init=function(e,r,a){this.enabled=!0,this.type=e,this.$element=t(r),this.options=this.getOptions(a),this.$viewport=this.options.viewport&&t(this.options.viewport.selector||this.options.viewport);for(var n=this.options.trigger.split(" "),o=n.length;o--;){var s=n[o];if("click"==s)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=s){var i="hover"==s?"mouseenter":"focusin",l="hover"==s?"mouseleave":"focusout";this.$element.on(i+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},r.prototype.getDefaults=function(){return r.DEFAULTS},r.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},r.prototype.getDelegateOptions=function(){var e={},r=this.getDefaults();return this._options&&t.each(this._options,function(t,a){r[t]!=a&&(e[t]=a)}),e},r.prototype.enter=function(e){var r=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return r&&r.$tip&&r.$tip.is(":visible")?void(r.hoverState="in"):(r||(r=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,r)),clearTimeout(r.timeout),r.hoverState="in",r.options.delay&&r.options.delay.show?void(r.timeout=setTimeout(function(){"in"==r.hoverState&&r.show()},r.options.delay.show)):r.show())},r.prototype.leave=function(e){var r=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return r||(r=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,r)),clearTimeout(r.timeout),r.hoverState="out",r.options.delay&&r.options.delay.hide?void(r.timeout=setTimeout(function(){"out"==r.hoverState&&r.hide()},r.options.delay.hide)):r.hide()},r.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var a=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!a)return;var n=this,o=this.tip(),s=this.getUID(this.type);this.setContent(),o.attr("id",s),this.$element.attr("aria-describedby",s),this.options.animation&&o.addClass("fade");var i="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,l=/\s?auto?\s?/i,c=l.test(i);c&&(i=i.replace(l,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(i).data("bs."+this.type,this),this.options.container?o.appendTo(this.options.container):o.insertAfter(this.$element);var d=this.getPosition(),u=o[0].offsetWidth,f=o[0].offsetHeight;if(c){var p=i,h=this.options.container?t(this.options.container):this.$element.parent(),g=this.getPosition(h);i="bottom"==i&&d.bottom+f>g.bottom?"top":"top"==i&&d.top-f<g.top?"bottom":"right"==i&&d.right+u>g.width?"left":"left"==i&&d.left-u<g.left?"right":i,o.removeClass(p).addClass(i)}var m=this.getCalculatedOffset(i,d,u,f);this.applyPlacement(m,i);var v=function(){var t=n.hoverState;n.$element.trigger("shown.bs."+n.type),n.hoverState=null,"out"==t&&n.leave(n)};t.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",v).emulateTransitionEnd(r.TRANSITION_DURATION):v()}},r.prototype.applyPlacement=function(e,r){var a=this.tip(),n=a[0].offsetWidth,o=a[0].offsetHeight,s=parseInt(a.css("margin-top"),10),i=parseInt(a.css("margin-left"),10);isNaN(s)&&(s=0),isNaN(i)&&(i=0),e.top=e.top+s,e.left=e.left+i,t.offset.setOffset(a[0],t.extend({using:function(t){a.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),a.addClass("in");var l=a[0].offsetWidth,c=a[0].offsetHeight;"top"==r&&c!=o&&(e.top=e.top+o-c);var d=this.getViewportAdjustedDelta(r,e,l,c);d.left?e.left+=d.left:e.top+=d.top;var u=/top|bottom/.test(r),f=u?2*d.left-n+l:2*d.top-o+c,p=u?"offsetWidth":"offsetHeight";a.offset(e),this.replaceArrow(f,a[0][p],u)},r.prototype.replaceArrow=function(t,e,r){this.arrow().css(r?"left":"top",50*(1-t/e)+"%").css(r?"top":"left","")},r.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},r.prototype.hide=function(e){function a(){"in"!=n.hoverState&&o.detach(),n.$element.removeAttr("aria-describedby").trigger("hidden.bs."+n.type),e&&e()}var n=this,o=this.tip(),s=t.Event("hide.bs."+this.type);return this.$element.trigger(s),s.isDefaultPrevented()?void 0:(o.removeClass("in"),t.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",a).emulateTransitionEnd(r.TRANSITION_DURATION):a(),this.hoverState=null,this)},r.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},r.prototype.hasContent=function(){return this.getTitle()},r.prototype.getPosition=function(e){e=e||this.$element;var r=e[0],a="BODY"==r.tagName,n=r.getBoundingClientRect();null==n.width&&(n=t.extend({},n,{width:n.right-n.left,height:n.bottom-n.top}));var o=a?{top:0,left:0}:e.offset(),s={scroll:a?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},i=a?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},n,s,i,o)},r.prototype.getCalculatedOffset=function(t,e,r,a){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-r/2}:"top"==t?{top:e.top-a,left:e.left+e.width/2-r/2}:"left"==t?{top:e.top+e.height/2-a/2,left:e.left-r}:{top:e.top+e.height/2-a/2,left:e.left+e.width}},r.prototype.getViewportAdjustedDelta=function(t,e,r,a){var n={top:0,left:0};if(!this.$viewport)return n;var o=this.options.viewport&&this.options.viewport.padding||0,s=this.getPosition(this.$viewport);if(/right|left/.test(t)){var i=e.top-o-s.scroll,l=e.top+o-s.scroll+a;i<s.top?n.top=s.top-i:l>s.top+s.height&&(n.top=s.top+s.height-l)}else{var c=e.left-o,d=e.left+o+r;c<s.left?n.left=s.left-c:d>s.width&&(n.left=s.left+s.width-d)}return n},r.prototype.getTitle=function(){var t,e=this.$element,r=this.options;return t=e.attr("data-original-title")||("function"==typeof r.title?r.title.call(e[0]):r.title)},r.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},r.prototype.tip=function(){return this.$tip=this.$tip||t(this.options.template)},r.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},r.prototype.enable=function(){this.enabled=!0},r.prototype.disable=function(){this.enabled=!1},r.prototype.toggleEnabled=function(){this.enabled=!this.enabled},r.prototype.toggle=function(e){var r=this;e&&(r=t(e.currentTarget).data("bs."+this.type),r||(r=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,r))),r.tip().hasClass("in")?r.leave(r):r.enter(r)},r.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type)})};var a=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=r,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=a,this}}(jQuery),+function(t){function e(e){return this.each(function(){var a=t(this),n=a.data("bs.popover"),o="object"==typeof e&&e,s=o&&o.selector;(n||"destroy"!=e)&&(s?(n||a.data("bs.popover",n={}),n[s]||(n[s]=new r(this,o))):n||a.data("bs.popover",n=new r(this,o)),"string"==typeof e&&n[e]())})}if("function"==typeof t().popover)return!0;var r=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");r.VERSION="3.3.1",r.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),r.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),r.prototype.constructor=r,r.prototype.getDefaults=function(){return r.DEFAULTS},r.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),r=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof r?"html":"append":"text"](r),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},r.prototype.hasContent=function(){return this.getTitle()||this.getContent()},r.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},r.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},r.prototype.tip=function(){return this.$tip||(this.$tip=t(this.options.template)),this.$tip};var a=t.fn.popover;t.fn.popover=e,t.fn.popover.Constructor=r,t.fn.popover.noConflict=function(){return t.fn.popover=a,this}}(jQuery),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(t){var e=t.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function(t){function e(e){e&&3===e.which||(t(n).remove(),t(o).each(function(){var a=t(this),n=r(a),o={relatedTarget:this};n.hasClass("open")&&(n.trigger(e=t.Event("hide.bs.dropdown",o)),e.isDefaultPrevented()||(a.attr("aria-expanded","false"),n.removeClass("open").trigger("hidden.bs.dropdown",o)))}))}function r(e){var r=e.attr("data-target");r||(r=e.attr("href"),r=r&&/#[A-Za-z]/.test(r)&&r.replace(/.*(?=#[^\s]*$)/,""));var a=r&&t(r);return a&&a.length?a:e.parent()}function a(e){return this.each(function(){var r=t(this),a=r.data("bs.dropdown");a||r.data("bs.dropdown",a=new s(this)),"string"==typeof e&&a[e].call(r)})}if("function"==typeof t().dropdown)return!0;var n=".dropdown-backdrop",o='[data-toggle="dropdown"]',s=function(e){t(e).on("click.bs.dropdown",this.toggle)};s.VERSION="3.3.1",s.prototype.toggle=function(a){var n=t(this);if(!n.is(".disabled, :disabled")){var o=r(n),s=o.hasClass("open");if(e(),!s){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&t('<div class="dropdown-backdrop"/>').insertAfter(t(this)).on("click",e);var i={relatedTarget:this};
if(o.trigger(a=t.Event("show.bs.dropdown",i)),a.isDefaultPrevented())return;n.trigger("focus").attr("aria-expanded","true"),o.toggleClass("open").trigger("shown.bs.dropdown",i)}return!1}},s.prototype.keydown=function(e){if(/(38|40|27|32)/.test(e.which)&&!/input|textarea/i.test(e.target.tagName)){var a=t(this);if(e.preventDefault(),e.stopPropagation(),!a.is(".disabled, :disabled")){var n=r(a),s=n.hasClass("open");if(!s&&27!=e.which||s&&27==e.which)return 27==e.which&&n.find(o).trigger("focus"),a.trigger("click");var i=" li:not(.divider):visible a",l=n.find('[role="menu"]'+i+', [role="listbox"]'+i);if(l.length){var c=l.index(e.target);38==e.which&&c>0&&c--,40==e.which&&c<l.length-1&&c++,~c||(c=0),l.eq(c).trigger("focus")}}}};var i=t.fn.dropdown;t.fn.dropdown=a,t.fn.dropdown.Constructor=s,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=i,this},t(document).on("click.bs.dropdown.data-api",e).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",o,s.prototype.toggle).on("keydown.bs.dropdown.data-api",o,s.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',s.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',s.prototype.keydown)}(jQuery),y.button_layout=function(t){return this.target=t,this.feature_set={},this.public_name={},this.sorters={},this.manual=[],this.manual_map={},this.manual_callback={},this._strip_punctuation=function(t){var e=t.replace(/[^a-zA-Z0-9 _]+/g,""),r=e.replace(/ +?/g,"");return r},this.data=function(t){return this._data=t,this},this.manual_button=function(t,e,r){return this.feature_set[t]=e,this.manual_map[this._strip_punctuation(t)]=t,this.manual_callback[t]=r,this},this.button=function(t){return arguments.length>1&&(this.public_name[t]=arguments[1]),arguments.length>2&&(this.sorters[t]=arguments[2]),this.feature_set[t]=[],this},this.callback=function(t){return this._callback=t,this},this.display=function(){var t,e,r,a,n=this._callback,o=this.manual_callback,s=this.manual_map;r=Object.keys(this.feature_set);for(var i=0;i<this._data.length;i++){t=this._data[i],e=r.map(function(e){return t[e]});for(var l=0;l<r.length;l++)a=r[l],-1==this.feature_set[a].indexOf(e[l])&&this.feature_set[a].push(e[l])}for(var a in this.feature_set)this.sorters.hasOwnProperty(a)&&this.feature_set[a].sort(this.sorters[a]);$(this.target).empty(),$(this.target).append("<div class='col-lg-12 segments text-center'></div>");for(var c in this.feature_set){r=this.feature_set[c],$(this.target+" div.segments").append('<div class="btn-group '+this._strip_punctuation(c)+'-btns text-left"><button type="button" class="btn btn-default btn-lg dropdown-toggle" data-toggle="dropdown"><span class=\'which-button\'>'+(this.public_name.hasOwnProperty(c)?this.public_name[c]:c)+"</span><span class='title'>"+(this.manual_callback.hasOwnProperty(c)?this.feature_set[c][0]:"all")+'</span><span class="caret"></span></button><ul class="dropdown-menu" role="menu">'+(this.manual_callback.hasOwnProperty(c)?"":'<li><a href="#" data-feature="'+c+'" data-key="all">All</a></li>')+(this.manual_callback.hasOwnProperty(c)?"":'<li class="divider"></li>')+"</ul></div>");for(var i=0;i<r.length;i++)"all"!=r[i]&&void 0!=r[i]&&$(this.target+" div."+this._strip_punctuation(c)+"-btns ul.dropdown-menu").append('<li><a href="#" data-feature="'+this._strip_punctuation(c)+'" data-key="'+r[i]+'">'+r[i]+"</a></li>");$("."+this._strip_punctuation(c)+"-btns .dropdown-menu li a").on("click",function(){var t,e=$(this).data("key"),r=$(this).data("feature");return $("."+r+"-btns button.btn span.title").html(e),s.hasOwnProperty(r)?(t=s[r],o[t](e)):n(r,e),!1})}return this},this},x.line=function(t){return this.args=t,this.init=function(t){return l(t),c(t),s(t),o(t),r(t),this},this.mainPlot=function(){var e,r=d3.select($(t.target).find("svg").get(0)),a=0,n=d3.svg.area().x(t.scalefns.xf).y0(t.scales.Y.range()[0]).y1(t.scalefns.yf).interpolate(t.interpolate),o=$(t.target).find("svg path.mg-confidence-band").first();if(o.length>0&&o.remove(),t.show_confidence_band)var e=d3.svg.area().x(t.scalefns.xf).y0(function(e){var r=t.show_confidence_band[0];return t.scales.Y(e[r])}).y1(function(e){var r=t.show_confidence_band[1];return t.scales.Y(e[r])}).interpolate(t.interpolate);for(var s,i=d3.svg.line().x(t.scalefns.xf).y(t.scalefns.yf).interpolate(t.interpolate),l=d3.svg.line().x(t.scalefns.xf).y(function(){return t.scales.Y(a)}).interpolate(t.interpolate),c="",d=t.data.length-1;d>=0;d--){s=t.data[d];var u=d+1;t.custom_line_color_map.length>0&&(u=t.custom_line_color_map[d]),t.show_confidence_band&&r.append("path").attr("class","mg-confidence-band").attr("d",e(t.data[d]));var f=$(t.target).find("svg path.mg-area"+u+"-color");t.area&&!t.use_data_y_min&&!t.y_axis_negative&&t.data.length<=1?f.length>0?($(r.node()).find(".mg-y-axis").after(f.detach()),d3.select(f.get(0)).transition().duration(function(){return t.transition_on_update?1e3:0}).attr("d",n(t.data[d]))):r.append("path").attr("class","mg-main-area mg-area"+u+"-color").attr("d",n(t.data[d])):f.length>0&&f.remove();var p=$(t.target).find("svg path.mg-main-line.mg-line"+u+"-color").first();p.length>0?($(r.node()).find(".mg-y-axis").after(p.detach()),d3.select(p.get(0)).transition().duration(function(){return t.transition_on_update?1e3:0}).attr("d",i(t.data[d]))):t.animate_on_load?(a=d3.median(t.data[d],function(e){return e[t.y_accessor]}),r.append("path").attr("class","mg-main-line mg-line"+u+"-color").attr("d",l(t.data[d])).transition().duration(1e3).attr("d",i(t.data[d]))):r.append("path").attr("class","mg-main-line mg-line"+u+"-color").attr("d",i(t.data[d])),t.legend&&(c="<span class='mg-line"+u+"-legend-color'>&mdash; "+t.legend[d]+"&nbsp; </span>"+c)}return t.legend&&$(t.legend_target).html(c),this},this.markers=function(){return i(t),this},this.rollover=function(){var e,r=d3.select($(t.target).find("svg").get(0)),a=$($(t.target).find("svg").get(0));a.find(".mg-rollover-rect").remove(),a.find(".mg-voronoi").remove(),a.find(".mg-active-datapoint").remove(),a.find(".mg-line-rollover-circle").remove(),r.append("text").attr("class","mg-active-datapoint").classed("mg-active-datapoint-small",t.use_small_class).attr("xml:space","preserve").attr("x",t.width-t.right).attr("y",t.top/2).attr("text-anchor","end"),r.append("circle").classed("mg-line-rollover-circle",!0).attr("cx",0).attr("cy",0).attr("r",0);for(var n=1,o=0;o<t.data.length;o++){for(var s=0;s<t.data[o].length;s++)t.data[o][s].line_id=t.custom_line_color_map.length>0?t.custom_line_color_map[o]:n;n++}if(t.data.length>1){var i=d3.geom.voronoi().x(function(e){return t.scales.X(e[t.x_accessor]).toFixed(2)}).y(function(e){return t.scales.Y(e[t.y_accessor]).toFixed(2)}).clipExtent([[t.buffer,t.buffer],[t.width-t.buffer,t.height-t.buffer]]),e=r.append("g").attr("class","mg-voronoi"),l=d3.nest().key(function(e){return t.scales.X(e[t.x_accessor])+","+t.scales.Y(e[t.y_accessor])}).rollup(function(t){return t[0]}).entries(d3.merge(t.data.map(function(t){return t}))).map(function(t){return t.values});e.selectAll("path").data(i(l)).enter().append("path").attr("d",function(t){return"M"+t.join("L")+"Z"}).datum(function(t){return t.point}).attr("class",function(e){if(t.linked){var r=e[t.x_accessor],a=d3.time.format("%Y-%m-%d"),n="number"==typeof r?o:a(r);return"mg-line"+e.line_id+"-color roll_"+n}return"mg-line"+e.line_id+"-color"}).on("mouseover",this.rolloverOn(t)).on("mouseout",this.rolloverOff(t))}else{var n=1;t.custom_line_color_map.length>0&&(n=t.custom_line_color_map[0]);var e=r.append("g").attr("class","mg-rollover-rect"),c=t.data[0].map(t.scalefns.xf);e.selectAll(".mg-rollover-rects").data(t.data[0]).enter().append("rect").attr("class",function(e,r){if(t.linked){var a=e[t.x_accessor],o=d3.time.format("%Y-%m-%d"),s="number"==typeof a?r:o(a);return"mg-line"+n+"-color roll_"+s}return"mg-line"+n+"-color"}).attr("x",function(t,e){return 0==e?c[e].toFixed(2):((c[e-1]+c[e])/2).toFixed(2)}).attr("y",function(e){return t.data.length>1?t.scalefns.yf(e)-6:t.top}).attr("width",function(t,e){return 0==e?((c[e+1]-c[e])/2).toFixed(2):e==c.length-1?((c[e]-c[e-1])/2).toFixed(2):((c[e+1]-c[e-1])/2).toFixed(2)}).attr("height",function(){return t.data.length>1?12:t.height-t.bottom-t.top-t.buffer}).attr("opacity",0).on("mouseover",this.rolloverOn(t)).on("mouseout",this.rolloverOff(t)).on("mousemove",this.rolloverMove(t))}return this},this.rolloverOn=function(t){{var e=d3.select($(t.target).find("svg").get(0));d3.time.format("%Y-%m-%d")}return function(r,a){if(e.selectAll("circle.mg-line-rollover-circle").attr("class","").attr("class","mg-area"+r.line_id+"-color").classed("mg-line-rollover-circle",!0).attr("cx",function(){return t.scales.X(r[t.x_accessor]).toFixed(2)}).attr("cy",function(){return t.scales.Y(r[t.y_accessor]).toFixed(2)}).attr("r",t.point_size).style("opacity",1),t.linked&&!y.globals.link){y.globals.link=!0;var n=r[t.x_accessor],o=d3.time.format("%Y-%m-%d"),s="number"==typeof n?a:o(n);d3.selectAll(".mg-line"+r.line_id+"-color.roll_"+s).each(function(t,e){d3.select(this).on("mouseover")(t,e)})}e.selectAll("text").filter(function(t){return r==t}).attr("opacity",.3);var i=d3.time.format("%b %e, %Y");if("count"==t.format)var l=function(e){var r=e%1!=0,a=d3.format("0,000");return e=r?d3.round(e,t.decimals):e,a(e)};else var l=function(e){var r=(t.decimals?"."+t.decimals:"")+"%",a=d3.format(r);return a(e)};t.show_rollover_text&&e.select(".mg-active-datapoint").text(function(){if(t.time_series){var e=new Date(+r[t.x_accessor]);return e.setDate(e.getDate()),i(e)+"  "+t.yax_units+l(r[t.y_accessor])}return t.x_accessor+": "+r[t.x_accessor]+", "+t.y_accessor+": "+t.yax_units+l(r[t.y_accessor])}),t.mouseover&&t.mouseover(r,a)}},this.rolloverOff=function(t){var e=d3.select($(t.target).find("svg").get(0));return function(r,a){if(t.linked&&y.globals.link){y.globals.link=!1;var n=r[t.x_accessor],o=d3.time.format("%Y-%m-%d"),s="number"==typeof n?a:o(n);d3.selectAll(".roll_"+s).each(function(t){d3.select(this).on("mouseout")(t)})}e.selectAll("circle.mg-line-rollover-circle").style("opacity",0),e.select(".mg-active-datapoint").text(""),t.mouseout&&t.mouseout(r,a)}},this.rolloverMove=function(t){return function(e,r){t.mousemove&&t.mousemove(e,r)}},this.init(t),this},x.histogram=function(t){return this.args=t,this.init=function(t){return l(t),d(t),s(t),o(t),r(t),this},this.mainPlot=function(){var e,r=d3.select($(t.target).find("svg").get(0)),a=$($(t.target).find("svg").get(0));a.find(".mg-histogram").remove();var e=r.append("g").attr("class","mg-histogram"),n=e.selectAll(".mg-bar").data(t.data[0]).enter().append("g").attr("class","mg-bar").attr("transform",function(e){return"translate("+t.scales.X(e[t.x_accessor]).toFixed(2)+","+t.scales.Y(e[t.y_accessor]).toFixed(2)+")"});return n.append("rect").attr("x",1).attr("width",function(){return(t.scalefns.xf(t.data[0][1])-t.scalefns.xf(t.data[0][0])-t.bar_margin).toFixed(2)}).attr("height",function(e){return 0==e[t.y_accessor]?0:(t.height-t.bottom-t.buffer-t.scales.Y(e[t.y_accessor])).toFixed(2)}),this},this.markers=function(){return i(t),this},this.rollover=function(){var e,r=d3.select($(t.target).find("svg").get(0)),a=$($(t.target).find("svg").get(0));a.find(".mg-rollover-rect").remove(),a.find(".mg-active-datapoint").remove(),r.append("text").attr("class","mg-active-datapoint").attr("xml:space","preserve").attr("x",t.width-t.right).attr("y",t.top/2).attr("text-anchor","end");var e=r.append("g").attr("class","mg-rollover-rect"),n=e.selectAll(".mg-bar").data(t.data[0]).enter().append("g").attr("class","mg-rollover-rects").attr("transform",function(e){return"translate("+t.scales.X(e[t.x_accessor])+",0)"});n.append("rect").attr("x",1).attr("y",0).attr("width",function(e,r){return r!=t.data[0].length-1?(t.scalefns.xf(t.data[0][r+1])-t.scalefns.xf(e)).toFixed(2):(t.scalefns.xf(t.data[0][1])-t.scalefns.xf(t.data[0][0])).toFixed(2)}).attr("height",function(){return t.height}).attr("opacity",0).on("mouseover",this.rolloverOn(t)).on("mouseout",this.rolloverOff(t)).on("mousemove",this.rolloverMove(t))},this.rolloverOn=function(t){{var e=d3.select($(t.target).find("svg").get(0));d3.time.format("%Y-%m-%d")}return function(r,a){e.selectAll("text").filter(function(t){return r==t}).attr("opacity",.3);var n=d3.time.format("%b %e, %Y");if("count"==t.format)var o=function(e){var r=e%1!=0,a=d3.format("0,000");return e=r?d3.round(e,t.decimals):e,a(e)};else var o=function(e){var r=(t.decimals?"."+t.decimals:"")+"%",a=d3.format(r);return a(e)};d3.selectAll($(t.target).find(" svg .mg-bar :eq("+a+")")).classed("active",!0),t.show_rollover_text&&e.select(".mg-active-datapoint").text(function(){if(t.time_series){var e=new Date(+r[t.x_accessor]);return e.setDate(e.getDate()),n(e)+"  "+t.yax_units+o(r[t.y_accessor])}return t.x_accessor+": "+o(r[t.x_accessor])+", "+t.y_accessor+": "+t.yax_units+o(r[t.y_accessor])}),t.mouseover&&t.mouseover(r,a)}},this.rolloverOff=function(t){var e=d3.select($(t.target).find("svg").get(0));return function(r,a){d3.selectAll($(t.target).find("svg .mg-bar :eq("+a+")")).classed("active",!1),e.select(".mg-active-datapoint").text(""),t.mouseout&&t.mouseout(r,a)}},this.rolloverMove=function(t){return function(e,r){t.mousemove&&t.mousemove(e,r)}},this.init(t),this},x.point=function(t){return this.args=t,this.init=function(t){return l(t),f(t),s(t),o(t),r(t),this},this.markers=function(){return i(t),t.least_squares&&p(t),this},this.mainPlot=function(){var e,r=d3.select($(t.target).find("svg").get(0)),a=$($(t.target).find("svg").get(0));a.find(".mg-points").remove(),e=r.append("g").classed("mg-points",!0);var n=e.selectAll("circle").data(t.data[0]).enter().append("svg:circle").attr("class",function(t,e){return"path-"+e}).attr("cx",t.scalefns.xf).attr("cy",t.scalefns.yf);return null!=t.color_accessor?(n.attr("fill",t.scalefns.color),n.attr("stroke",t.scalefns.color)):n.classed("mg-points-mono",!0),null!=t.size_accessor?n.attr("r",t.scalefns.size):n.attr("r",t.point_size),this},this.rollover=function(){var e=d3.select($(t.target).find("svg").get(0)),r=$($(t.target).find("svg").get(0));r.find(".mg-voronoi").remove(),r.find(".mg-active-datapoint").remove(),e.append("text").attr("class","mg-active-datapoint").attr("xml:space","preserve").attr("x",t.width-t.right).attr("y",t.top/2).attr("text-anchor","end");var a=d3.geom.voronoi().x(t.scalefns.xf).y(t.scalefns.yf).clipExtent([[t.buffer,t.buffer],[t.width-t.buffer,t.height-t.buffer]]),n=e.append("g").attr("class","mg-voronoi");return n.selectAll("path").data(a(t.data[0])).enter().append("path").attr("d",function(t){return void 0!=t?"M"+t.join(",")+"Z":void 0}).attr("class",function(t,e){return"path-"+e}).style("fill-opacity",0).on("mouseover",this.rolloverOn(t)).on("mouseout",this.rolloverOff(t)).on("mousemove",this.rolloverMove(t)),this},this.rolloverOn=function(t){var e=d3.select($(t.target).find("svg").get(0));return function(r,a){e.selectAll(".mg-points circle").classed("selected",!1);var n=e.selectAll(".mg-points circle.path-"+a).classed("selected",!0);t.size_accessor?n.attr("r",function(e){return t.scalefns.size(e)+1}):n.attr("r",t.point_size),t.linked&&!globals.link&&(globals.link=!0,d3.selectAll(".mg-voronoi .path-"+a).each(function(){d3.select(this).on("mouseover")(r,a)}));var o=d3.time.format("%b %e, %Y");if("count"==t.format)var s=function(e){var r=e%1!=0,a=d3.format("0,000");return e=r?d3.round(e,t.decimals):e,a(e)};else var s=function(e){var r=(t.decimals?"."+t.decimals:"")+"%",a=d3.format(r);return a(e)};t.show_rollover_text&&e.select(".mg-active-datapoint").text(function(){if(t.time_series){var e=new Date(+r.point[t.x_accessor]);return e.setDate(e.getDate()),o(e)+"  "+t.yax_units+s(r.point[t.y_accessor])}return t.x_accessor+": "+s(r.point[t.x_accessor])+", "+t.y_accessor+": "+t.yax_units+s(r.point[t.y_accessor])}),t.mouseover&&t.mouseover(r,a)}},this.rolloverOff=function(t){var e=d3.select($(t.target).find("svg").get(0));return function(r,a){t.linked&&globals.link&&(globals.link=!1,d3.selectAll(".mg-voronoi .path-"+a).each(function(){d3.select(this).on("mouseout")(r,a)}));var n=e.selectAll(".mg-points circle").classed("unselected",!1).classed("selected",!1);t.size_accessor?n.attr("r",t.scalefns.size):n.attr("r",t.point_size),e.select(".mg-active-datapoint").text(""),t.mouseout&&t.mouseout(r,a)}},this.rolloverMove=function(t){return function(e,r){t.mousemove&&t.mousemove(e,r)}},this.update=function(){return this},this.init(t),this},x.bar=function(t){return this.args=t,this.init=function(t){return l(t),u(t),s(t),o(t),a(t),this},this.mainPlot=function(){var e,r=d3.select($(t.target).find("svg").get(0)),a=$($(t.target).find("svg").get(0));a.find(".mg-barplot").remove();var n=t.data[0],e=r.append("g").classed("mg-barplot",!0),o=t.scales.Y.rangeBand()/1.5;if(e.selectAll(".mg-bar").data(n).enter().append("rect").classed("mg-bar",!0).attr("x",t.scales.X(0)).attr("y",function(e){return t.scalefns.yf(e)+o/2}).attr("height",o).attr("width",function(e){return t.scalefns.xf(e)-t.scales.X(0)}),t.predictor_accessor){var s=t.predictor_proportion,i=s-1;e.selectAll(".mg-prediction").data(n).enter().append("rect").attr("class","mg-bar-prediction").attr("x",t.scales.X(0)).attr("y",function(e){return t.scalefns.yf(e)+i*o/(2*s)+o/2}).attr("height",o/s).attr("width",function(e){return t.scales.X(e[t.predictor_accessor])-t.scales.X(0)})}return t.baseline_accessor&&e.selectAll(".mg-baseline").data(n).enter().append("line").attr("class","mg-bar-baseline").attr("x1",function(e){return t.scales.X(e[t.baseline_accessor])}).attr("x2",function(e){return t.scales.X(e[t.baseline_accessor])}).attr("y1",function(e){return t.scalefns.yf(e)+o/2-o/s+o/2}).attr("y2",function(e){return t.scalefns.yf(e)+o/2+o/s+o/2}),this},this.markers=function(){return i(t),this},this.rollover=function(){var e,r=d3.select($(t.target).find("svg").get(0)),a=$($(t.target).find("svg").get(0));a.find(".mg-rollover-rect").remove(),a.find(".mg-active-datapoint").remove(),r.append("text").attr("class","mg-active-datapoint").attr("xml:space","preserve").attr("x",t.width-t.right).attr("y",t.top/2).attr("dy",".35em").attr("text-anchor","end");{var e=r.append("g").attr("class","mg-rollover-rect");e.selectAll(".mg-bar").data(t.data[0]).enter().append("rect").attr("class","bar-rollover").attr("x",t.scales.X(0)).attr("y",t.scalefns.yf).attr("width",t.width).attr("height",t.scales.Y.rangeBand()+2).attr("opacity",0).on("mouseover",this.rolloverOn(t)).on("mouseout",this.rolloverOff(t)).on("mousemove",this.rolloverMove(t))}},this.rolloverOn=function(t){{var e=d3.select($(t.target).find("svg").get(0));d3.time.format("%Y-%m-%d")}return function(r,a){e.selectAll("text").filter(function(t){return r==t}).attr("opacity",.3);var n=d3.time.format("%b %e, %Y");if("count"==t.format)var o=function(e){var r=e%1!=0,a=d3.format("0,000");return e=r?d3.round(e,t.decimals):e,a(e)};else var o=function(e){var r=(t.decimals?"."+t.decimals:"")+"%",a=d3.format(r);return a(e)};d3.selectAll($(t.target+" svg g.mg-barplot .mg-bar:eq("+a+")")).classed("active",!0),t.show_rollover_text&&e.select(".mg-active-datapoint").text(function(){if(t.time_series){var e=new Date(+r[t.x_accessor]);return e.setDate(e.getDate()),n(e)+"  "+t.yax_units+o(r[t.y_accessor])}return r[t.y_accessor]+": "+o(r[t.x_accessor])}),t.mouseover&&t.mouseover(r,a)}},this.rolloverOff=function(t){var e=d3.select($(t.target).find("svg").get(0));return function(r,a){d3.selectAll($(t.target).find("svg g.mg-barplot .mg-bar:eq("+a+")")).classed("active",!1),e.select(".mg-active-datapoint").text(""),t.mouseout&&t.mouseout(r,a)}},this.rolloverMove=function(t){return function(e,r){t.mousemove&&t.mousemove(e,r)}},this.init(t),this},y.data_table=function(e){return this.args=e,this.args.standard_col={width:150,font_size:12,font_weight:"normal"},this.args.columns=[],this.formatting_options=[["color","color"],["font-weight","font_weight"],["font-style","font_style"],["font-size","font_size"]],this._strip_punctuation=function(t){var e=t.replace(/[^a-zA-Z0-9 _]+/g,""),r=e.replace(/ +?/g,"");return r},this._format_element=function(t,e,r){this.formatting_options.forEach(function(a){var n=a[0],o=a[1];r[o]&&t.style(n,"string"==typeof r[o]||"number"==typeof r[o]?r[o]:r[o](e))})},this._add_column=function(t,e){var r=this.args.standard_col,a=g(y.clone(t),y.clone(r));a.type=e,this.args.columns.push(a)},this.target=function(){var t=arguments[0];return this.args.target=t,this},this.title=function(){return this._add_column(arguments[0],"title"),this},this.text=function(){return this._add_column(arguments[0],"text"),this},this.bullet=function(){return this},this.sparkline=function(){return this},this.number=function(){return this._add_column(arguments[0],"number"),this},this.display=function(){var e,r=this.args;t(r);var e,a,n,o,s,i,l,c,d,u,f,p=r.target,h=d3.select(p).append("table").classed("mg-data-table",!0),g=h.append("colgroup"),m=h.append("thead"),v=h.append("tbody");n=m.append("tr");for(var _=0;_<r.columns.length;_++){var y=r.columns[_];i=y.type,c=y.label,c=void 0==c?"":c,o=n.append("th").style("width",y.width).style("text-align","title"==i?"left":"right").text(c),y.description&&(o.append("i").classed("fa",!0).classed("fa-question-circle",!0).classed("fa-inverse",!0),$(o[0]).popover({html:!0,animation:!1,content:y.description,trigger:"hover",placement:"top",container:$(o[0])}))}for(var _=0;_<r.columns.length;_++)f=g.append("col"),"number"==r.columns[_].type&&f.attr("align","char").attr("char",".");for(var x=0;x<r.data.length;x++){n=v.append("tr");for(var b=0;b<r.columns.length;b++){if(e=r.columns[b],s=e.accessor,l=d=r.data[x][s],i=e.type,"number"==i){if(e.hasOwnProperty("round")&&!e.hasOwnProperty("format")&&(d=d3.format("0,."+e.round+"f")(d)),e.hasOwnProperty("value_formatter")&&(d=e.value_formatter(d)),e.hasOwnProperty("format")){e.round&&(d=d3.round(d,e.round));var w,k=e.format;"percentage"==k&&(w=d3.format("%p")),"count"==k&&(w=d3.format("0,000")),"temperature"==k&&(w=function(t){return t+""}),d=w(d)}e.hasOwnProperty("currency")&&(d=e.currency+d)}u=n.append("td").classed("table-"+i,!0).classed("table-"+i+"-"+this._strip_punctuation(s),!0).attr("data-value",l).style("width",e.width).style("text-align","title"==i||"text"==i?"left":"right"),this._format_element(u,l,e),"title"==i?(a=u.append("div").text(d),this._format_element(a,d,e),r.columns[b].hasOwnProperty("secondary_accessor")&&u.append("div").text(r.data[x][r.columns[b].secondary_accessor]).classed("secondary-title",!0)):u.text(d)}}return this},this},x.missing=function(e){return this.args=e,this.init=function(e){t(e),d3.select(e.target).selectAll("svg").data([e]).enter().append("svg").attr("width",e.width).attr("height",e.height),d3.select(e.target).selectAll("svg *").remove();var r=d3.select(e.target).select("svg");return r.classed("mg-missing",!0),e.legend_target&&$(e.legend_target).html(""),r.append("rect").attr("class","mg-missing-pane").attr("x",e.left).attr("y",e.top).attr("width",e.width-2*e.left).attr("height",e.height-2*e.top),r.selectAll(".mg-missing-text").data([e.missing_text]).enter().append("text").attr("class","mg-missing-text").attr("x",e.width/2).attr("y",e.height/2).attr("dy",".50em").attr("text-anchor","middle").text(e.missing_text),this},this.init(e),this},y.convert={},y.convert.date=function(t,e,r){return r="undefined"==typeof r?"%Y-%m-%d":r,t=t.map(function(t){var a=d3.time.format(r);return t[e]=a.parse(t[e]),t})},y.convert.number=function(t,e){return t=t.map(function(t){return t[e]=Number(t[e]),t})};var b=function(t,e,r){if(null==t)return t;if(Array.prototype.forEach&&t.forEach===Array.prototype.forEach)t.forEach(e,r);else if(t.length===+t.length){for(var a=0,n=t.length;n>a;a++)if(e.call(r,t[a],a,t)===breaker)return}else for(var o in t)if(e.call(r,t[o],o,t)===breaker)return;return t};y.clone=function(t){if(null==t||"object"!=typeof t)return t;if(t instanceof Date){var e=new Date;return e.setTime(t.getTime()),e}if(t instanceof Array){for(var e=[],r=0,a=t.length;a>r;r++)e[r]=y.clone(t[r]);return e}if(t instanceof Object){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=y.clone(t[n]));return e}throw new Error("Unable to copy obj! Its type isn't supported.")},"function"==typeof define&&define.amd?define(y):"object"==typeof module&&module.exports&&(module.exports=y),window.MG=y}();